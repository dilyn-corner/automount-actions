#!/bin/sh

# readonly _watch_file="$SNAP_COMMON/watched"
readonly _watch_file="/tmp/devices.fifo"

init_watch_file() {
    [ -p "$_watch_file" ] || mkfifo "$_watch_file"
}

init_log() {
    _arg_log_file="$1"
    _arg_log_dir="$(dirname "$_arg_log_file")"

    [ -d "$_arg_log_dir" ] || mkdir -p "$_arg_log_dir"

    touch "$_arg_log_file"
}

# log to SNAP_COMMON and TTY
log() {
    printf '%s %s\n' \
        "$(date -Iseconds)" "$1" | tee -a "${_log_file}"
}
